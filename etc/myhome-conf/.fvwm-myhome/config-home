#######################
# ChenBK at 20131020 02:16
#
# FVWM config setup


####
#  全局变量
#######
# 路径变量
SetEnv fvwm_img $[FVWM_USERDIR]/images
SetEnv fvwm_icon $[FVWM_USERDIR]/icons
SetEnv fvwm_script $[FVWM_USERDIR]/script.d
SetEnv fvwm_wallpaper $[FVWM_USERDIR]/wallpaper
# SetEnv fvwm-img $[FVWM_USERDIR]/.fvwm/images
# 默认程序变量
SetEnv FvwmBrowser /usr/bin/firefox
SetEnv FvwmXterm /usr/bin/uxterm
SetEnv FvwmAlsa /usr/bin/alsamixer

####
# 取消 默认绑定
######
Key Help R A -
Key F1 R A -
Key Escape A MC -

Mouse 1 R A -
Mouse 1 T A -
Mouse 1 FS A -
Mouse 2 FST A -

####
# 图片路径
#######
ImagePath +:/usr/share:/usr/share/icons/locolor/32x32/apps/:/usr/share/icons/locolor/16x16/apps:/usr/share/icons/gnome/16x16/apps:/usr/share/icons/gnome/24x24/apps:/usr/share/icons/hicolor/22x22/apps:/usr/share/icons/gnome/24x24/actions/usr/share/icons/gnome/24x24/status:/usr/share/icons/gnome/16x16/actions:/usr/share/icons:/usr/share/pixmaps:/usr/share/icons/hicolor/24x24/apps:/usr/share/icos/hicolor/48x48/apps:$[fvwm_icon]:$[fvwm_wallpapers]


####
# 虚拟桌面个数
######
DeskTopSize 2x2
DesktopName 0 主桌面
DesktopName 1 任务桌面
DesktopName 2 休闲桌面
#EdgeScroll 100 100
#EdgeResistance 500 500
# 自动滚屏 1-开启 0-禁用
EdgeThickness 0     

####
# 桌面页配置
######
Style "FvwmPager" NoTitle,NoHandles,BorderWidth 0,Sticky,\
	WindowListSkip, CirculateSkip,StaysOnBottom,FixedPosition,\
	FixedSize, !Iconifiable
DestroyModuleConfig FvwmPager: *
*FvwmPager: MiniIcons
*FvwmPager: Window3DBorders
*FvwmPager: MiniIcons
*FvwmPager: Colorset * 11
*FvwmPager: HilightColorset * 10
*FvwmPager: ShapeLabels
*FvwmPager: SolidSeparators
*FvwmPager: Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antialias=True"
*FvwmPagerLabel 0 主桌面
*FvwmPagerLabel 1 任务桌面
*FvwmPagerLabel 2 休闲桌面


####
# 鼠标获得焦点
######
ClickTime 350
MoveThreshold 3
Style * SloppyFocus, MouseFocusClickRaises


####
# 默认桌面环境
######
EwmhBaseStruts 0 0 0 50
IgnoreModifiers L25

####
# 全局样式定义
######
Style * FocusFollowsMouse
Style * DecorateTransient
Style * SmartPlacement,WindowShadeSteps 10, ResizeOpaque
Style * SnapAttraction Windows
Style * Borders, NoTitle, BorderWidth 5, HandleWidth 5, DepressableBorder
Style * NoIconTitle
Style * TitleCascadePlacement, GrabFocusOff
Style * SnapGrid 5 5
Style * Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=12:antialias=True"
Style * NoPPosition, ResizeOpaque
Style * SloppyFocus, MouseFocusClickRaises
Style "*" MWMFunctions
Style "*" HintOverride
Style "*" MWMDecor
Style "*" MWMBorder
Style "*" NoIcon
# Style "Fvwm*" NoTitle, Sticky, WindowListSkip
Style "Fvwm*" BorderWidth 2, CirculateSkipIcon, CirculateSkip
# Style "MainPanel" StaysOnTop
Style "PagerPanel" StaysOnTop
Style "FvwmBanner" StaysOnTop
OpaqueMoveSize 100
Emulate MWM
HideGeometryWindow Never
SnapAttraction 5 SameType Screen
SnapGrid 3 3
XorValue 55555




####
# 单个程序样式定义
######
Style "*" Icon 48x48/unknown.xpm
Style "*term" Icon 48x48/xterm.png, TitleAtLeft, NoActiveIconOverride, \
	MiniIcon mini/xterm.png
Style "*Chrome" NoTitle, NoActiveIconOverride
Style "Firefox" Icon 48x48/firefox.png NoActiveIconOveride, \
	MinIcon mini/firefox.png




####
# 程序运行函数
#######
DestroyFunc FvwmXTerm
AddToFunc FvwmXTerm
+ I Exec exec uxterm



####
# 启动\初始化\重新启动\关闭 函数
######
DestroyFunc StartFunction
AddToFunc StartFunction
+ I Module FvwmAudio
# + I Module FvwmTaskBar
# + I Module FvwmTabs
#+ I Module FvwmPager 0 2
# + I Module FvwmButtons MainPanel


DestroyFunc InitFunction
AddToFunc InitFunction
# + I Exec exec xscreensaver
# + I Exec exec fvwm-root -r ~/.fvwm/wallpapers/1.png
# + I Exec exec fbpanel
+ I Exec exec ~/.conky-myhome/bin/conkyStart
# + I Exec exec xloadimage -onroot -fullscreen $[fvwm_wallpapers]/1.png
# + I Exec exec pcmanfm --desktop
# + I Exec exec tint2
+ I Exec exec fcitx
+ I Exec exec xrdb ~/.Xresources

DestroyFunc RestartFunction
AddToFunc RestartFunction
# + I Exec exec ~/.conky-myhome/bin/conkyStart
+ I Exec exec xrdb ~/.Xresources
+ I Nop


DestroyFunc ExitFunction
AddToFunc ExitFunction
+ I All (fbpanel) Close
+ I All (pcmanfm) Close
+ I All (conky) Close
+ I All (fcitx) Close

####
# 快捷键绑定
######
Key F1 A M Menu FuncMenu
Key F3 A A Module FvwmConsole -terminal uxterm -geometry 50x6+45+450 \
	-bg gold -fg midnightblue
Key Tab A M WindowList Root c c NoDeskSort, SelectOnRelease Meta_L

###  Win+D 可以调出桌面面板,但一直加,不知道怎么让它作判断.
#Key  D A 4 Module FvwmButtons PagerPanel
##


# Alt+Ctrl+n 标记n号窗回,Ctrl+n回到n号标记的窗口
Key 0 WI MC Key 0 A C WindowId $[w.id] WarpToWindow 50 50
Key 1 WI MC Key 1 A C WindowId $[w.id] WarpToWindow 50 50
Key 2 WI MC Key 2 A C WindowId $[w.id] WarpToWindow 50 50
Key 3 WI MC Key 3 A C WindowId $[w.id] WarpToWindow 50 50
Key 4 WI MC Key 4 A C WindowId $[w.id] WarpToWindow 50 50
Key 5 WI MC Key 5 A C WindowId $[w.id] WarpToWindow 50 50
Key 6 WI MC Key 6 A C WindowId $[w.id] WarpToWindow 50 50
Key 7 WI MC Key 7 A C WindowId $[w.id] WarpToWindow 50 50
Key 8 WI MC Key 8 A C WindowId $[w.id] WarpToWindow 50 50
Key 9 WI MC Key 9 A C WindowId $[w.id] WarpToWindow 50 50


###### Start_1  Ctrl+Shift+n 标记n号窗回,Alt+n回到n号标记的窗口
#Key 0 WI SC State 0
#Key 1 WI SC State 1
#Key 2 WI SC State 2
#Key 3 WI SC State 3
#Key 4 WI SC State 4
#Key 5 WI SC State 5
#Key 6 WI SC State 6
#Key 7 WI SC State 7
#Key 8 WI SC State 8
#Key 9 WI SC State 9

#DestroyFunc GroupFunc
#AddToFunc GroupFunc I Layer 1
#+ I MoveToPage
#+ I Iconify off
#+ I Raise

#Key 0 A M All (State 0) GroupFunc
#Key 1 A M All (State 1) GroupFunc
#Key 2 A M All (State 2) GroupFunc
#Key 3 A M All (State 3) GroupFunc
#Key 4 A M All (State 4) GroupFunc
#Key 5 A M All (State 5) GroupFunc
#Key 6 A M All (State 6) GroupFunc
#Key 7 A M All (State 7) GroupFunc
#Key 8 A M All (State 8) GroupFunc
#Key 9 A M All (State 9) GroupFunc
####### End_1



####
# 鼠标设定
######
Mouse 3 R A Menu ConfMenu Nop
Mouse 1 RD A Menu FuncMenu Nop
Mouse 1 A C Menu FuncMenu Nop
Mouse 1 W M FvwmMoveOrIconify
Mouse 1 I A FvwmMoveOrIconify


# 预留 Ctrl + Mouse 右键 实现Scroll 功能.



####
# 菜单 颜色
######
Colorset 7 fg Black, bg #e6e7d7, sh Black, hi #202070
Colorset 8 fg DarkRed, bg #e6e7d7, sh Black, hi #202070


####
# 菜单的风格
######
MenuStyle * MWM
MenuStyle * PopupDelayed, PopupDelay 160, Animation, TitleWarp
MenuStyle * Foreground gold, Background gray40
MenuStyle * ActiveFore White
MenuStyle * MenuFace VGradient 64 darkgray MidnightBlue
MenuStyle * Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=14:antialias=True"
# MenuStyle * PopupOffset -5 100, TitleWarpOff
# MenuStyle * TitleUnderlines2, SeparatorsLong, TriangLesSolid
# MenuStyle * AnimationOff, AutomaticHotkeyOff
# MenuStyle * BorderWidth 2
# MenuStyle * PopupAsSubmenu, HoldSubmenus, SubmenusRight
# MenuStyle * ItemFormat "%|%5.5i%1.31%2.3>%|"
# MenuStyle * VerticalItemSpacing 1 1, VerticalTitleSpacing 2 2
# MenuStyle * MenuColorset 7
# MenuStyle * ActiveFore, Hilight3DOff
# MenuStyle * ActiveColorset 8


####
# 菜单内容
######
DestroyMenu FuncMenu
AddToMenu FuncMenu "%fcitx.png%=== 主菜单===" Title
+ "终端  - &Xterm%utilities-terminal.png%"  Exec exec uxterm
+ "浏览器- &Firefox%web-browser.png%"  Exec exec firefox
+ "浏览器- &Opera%opera-browser.png%"  Exec exec opera
+ "浏览器- &Chrome%google-chrome.png%"  Exec exec google-chrome
+ "播放器- X&BMC%xbmc/media/icon32x32.png%"  Exec exec xbmc
+ "文件库- &PCmanFM%system-file-manager.png%"  Exec exec pcmanfm
+ ""  Nop
+ "办公软件%libreoffice-writer.png%"   Popup OfficeMenu
+ "应用程序"   Popup ProgramsMenu
+ "工具"   Popup UtilitiesMenu
+ ""  Nop
+ "注销%application-exit.png%"   Quit
+ "重启%view-refresh.png%"   Exec exec sudo shutdown -r now
+ "关机"   Exec exec sudo shutdown -h now


DestroyMenu ConfMenu
AddToMenu ConfMenu "%fcitx.png%=== 配置菜单===" Title
+ "&Git Add /%utilities-terminal.png%"  Exec exec cd / && git add .

####
# 按钮配置
######
Style "FvwmButtons" NoTitle,NoHandles,BorderWidth 0,Sticky,\
	WindowListSkip,CirculateSkip,StaysOnBoottom,FixedPosition,\
	FixedSize, !Iconifiable


DestroyModuleConfig LaunchInfo: *
Style LaunchInfo Sticky, StaysOnTop
*LaunchInfo: Rows 5
*LaunchInfo: Columns 5
*LanuchInfo: Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antalias=True"
*LaunchInfo: Colorset 30
*LaunchInfo: Frame 1
*LaunchInfo: (3x3, Icon logo_72.png,Action (Mouse 1) Menu FuncMenu )
*LaunchInfo: (2x2, Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=18:antalias=True", Swallow "FvwmPager" "FvwmPager")
#*LaunchInfo: (1x1, Title "1", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=18:antalias=True", Action (Mouse 1) GoToPage 0 0)
#*LaunchInfo: (1x1, Title "2", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=18:antalias=True", Action (Mouse 1) GoToPage 1 0)
#*LaunchInfo: (1x1, Title "3", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=18:antalias=True", Action (Mouse 1) GoToPage 0 1)
#*LaunchInfo: (1x1, Title "4", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=18:antalias=True", Action (Mouse 1) GoToPage 1 1)
*LaunchInfo: (2x3, Title "天气", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antalias=True")
*LaunchInfo: (3x2, Title "日期", Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antalias=True")

#*LaunchTime: (1x2,Title "Chrome", Icon google-chrome.png Action (Mouse 1) `Exec google-chrome`)
# *LaunchTime: (3x1)
Module FvwmButtons -g 150x150+0-0 LaunchInfo



#*FvwmButtonsBack bisque3
#*MainPanel: Geometry 120x18+2+2
#*MainPanel: Back SeaGreen
#*MainPanel: (Title "桌面 [Win+D]", Panel(down, indicator, delay 0, steps 1) \
#	PagerPanel "Module FvwmButtons PagerPanel")
#*MainPanel: Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antalias=True"
#*PagerPanel: Geometry 120x352
#*PagerPanel: (Swallow FvwmPager "Module FvwmPager 0 2")
#*PagerPanelBack #908090
#*PagerPanelFore #484048
#*PagerPanel: Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=10:antialias=True"


# Module FvwmButtons MainPanel


####
# 工具栏
######
#Style "FvwmTaskBar" HandleWidth 3, BorderWidth 4, NoTitle, Sticky,\
#	StaysOnTop, WindowListSkip, CirculasteSkip
#*FvwmTaskBar: UseSkipList
#*FvwmTaskBar: AutoStick
#*FvwmTaskBar: DeskOnly
#*FvwmTaskBar: Action Click1 DeiconifyRaiseAndFocus
#*FvwmTaskBar: Action Click2 Iconify On
#*FvwmTaskBar: Action Click3 Lower
#*FvwmTaskBar: MailCommand Exec exec uxtrem -e mutt
#*FvwmTaskBar: 3DFvwm
#*FvwmTaskBar: StartName Gentoo
#*FvwmTaskBar: StartMenu FuncMenu
#*FvwmTaskBar: StartIcon fcitx.png
#*FvwmTaskBar: Button Icon utilities-terminal.png , Action (Mouse 1) FvwmXterm
#*FvwmTaskBar: Font "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=12:antialias=True"
#*FvwmTaskBar: SelFont "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=12:antialias=True"
#*FvwmTaskBar: StatusFont "StringEncoding=UTF-8:xft:Droid Sans Fallback:pixelsize=12:antialias=True"
#*FvwmTaskBar: ShowTips
#*FvwmTaskBar: ClockFormat %m-%d [%A] %H:%M
#*FvwmTaskBar: windowButtionsRightMargin 20
#*FvwmTaskBar: Back seagreen
#*FvwmTaskBar: Fore gold2
#*FvwmTaskBar: FocusFore cornsilk
#*FvwmTaskBar: IconBack darkgreen
#*FvwmTaskBar: IconFore white
#*FvwmTaskBar: BellVolume 50


AddToFunc DeiconifyRaiseAndFocus
+ I Iconify off
+ I Raise
+ I Focus

####
# 任务栏点击最小化和还原,不生效
######
# DestroyFunc DeiconifyRaiseAndFocus 
# AddToFunc DeiconifyRaiseAndFocus
# + I Current (State 5) DeiconifyRaiseAndFocus-on
# + I TestRc Current (Iconify on) DeiconifyRaiseAndFocus-off


# DestroyFunc DeiconifyRaiseAndFocus-off
# AddToFunc DeiconifyRaiseAndFocus-off
# + I Current (!Iconify on) Iconify on
# + I State 5 true  
  
# DestroyFunc DeiconifyRaiseAndFocus-on
# AddToFunc DeiconifyRaiseAndFocus-on
# + I Iconify off
# + I Raise
# + I Focus

####  Error
# FvwmTabs
######
setTitleAndIcon () { print -nP '%{\e]2;'$1'\a\e]}1;'$2'\a%'}
preexec () { setTitleAndIcon $1 ${1%% *} }
precmd () { setTitleAndIcon %n@%m %m }

NewTabber --geometry=+200+400 scottie
SetEnv FvwmTabs_NoDefaultSetup

#Key (FvwmTabs*) A A CM Function AddTab

Function SwallowNew lastFocus Exec exec xterm

####
# Win+D 最小化所有窗口
######
DestroyFunc FuncFvwmIconifyTrue
AddToFunc FuncFvwmIconifyTrue
+ I All (!Iconic, !Fvwm*) State 1
+ I All (State 1) Iconify True

DestroyFunc FuncFvwmIconifyFalse
AddToFunc FuncFvwmIconifyFalse
+ I All (State 1) Iconify False

DestroyFunc FuncFvwmIconifyToggle
AddToFunc FuncFvwmIconifyToggle
+ I FuncFvwmIconifyFalse
+ I All (State 1) State 1 False
+ I TestRc (NoMatch) FuncFvwmIconifyTrue

Key D A 4 FuncFvwmIconifyToggle

####
# Win+L 锁屏
######
DestroyFunc FuncFvwmLockScreen
AddToFunc FuncFvwmLockScreen
+ I All (xscreensaver) Nop
+ I TestRc (NoMatch) Exec xscreensaver -no-splash &
+ I Exec xscreensaver-command -lock

Key L A 4 FuncFvwmLockScreen


####
# Focus 测试
######
DestroyFunc SelectWindow
AddToFunc SelectWindow
+ I Focus
+ I Iconify false
+ I Raise
+ I WarpToWindow 50 8p

# Mouse 1 R A SelectWindow


####
# 桌面
######
# DestroyFunc StartFunction

# Test (!EnvIsSet fvwm_wallpapers) AddToFunc StartFunction
#	+ I PipeRead 'fvwm-root --retain-pixmap $[fvwm_wallpapers]/1.png'

Test (EnvIsSet fvwm_wallpaper) AddToFunc StartFunction
	+ I PipeRead 'fvwm-root --retain-pixmap $[fvwm_wallpaper]/1.png' 


####
# 
######
DestroyFunc FuncFullScreen  
AddtoFunc FuncFullScreen  
+ I Current (State 0) Fullscreen-Stop   
+ I TestRc Current (Maximizable) Fullscreen-Start  
  
DestroyFunc Fullscreen-Start  
AddtoFunc Fullscreen-Start  
+ I WindowStyle NoTitle,HandleWidth 0,FixedSize,FixedPosition  
+ I Current (!Maximized) Maximize  
+ I ResizeMaximize 100 100  
+ I State 0 true  
  
DestroyFunc Fullscreen-Stop  
AddtoFunc Fullscreen-Stop  
+ I DestroyWindowStyle  
+ I State 0 false  
+ I Maximize  

Key F A 4 FuncFullScreen
Key F4 A M Close
Mouse 3 W M FuncFullScreen

####
# 窗口移动,图标还原.
######
Mouse 3 T C FvwmMoveOrRaise

DestroyFunc FvwmMoveOrRaise
AddToFunc FvwmMoveOrRaise "M" Move
+ I "C" Raise

Mouse 0 I A FvwmMoveOrIconify

DestroyFunc FvwmMoveOrIconify
AddToFunc FvwmMoveOrIconify "M" Move
+ "D" Iconify

####
# 右边Win键启动 Xterm
######
Key Super_R A A Exec exec uxterm



####
# 按Ctrl+Alt+软件首字母,将这类软件移到当前窗口,再按一次或选中某个时还原回去.
######
